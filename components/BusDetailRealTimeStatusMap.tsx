import React, { useState, useEffect } from "react";

import styled from "styled-components";
import { useRouter } from "next/router";
import { styled as muiStyled } from "@mui/material/styles";
import { useForm, useWatch, Controller, SubmitHandler } from "react-hook-form";

import Box from "@mui/material/Box";
import Card from "@mui/material/Card";
import Button from "@mui/material/Button";
import Typography from "@mui/material/Typography";
import Grid from "@mui/material/Grid";
import Stack from "@mui/material/Stack";
import List from "@mui/material/List";

import {
  GoogleMap,
  Marker,
  Polyline,
  useJsApiLoader,
} from "@react-google-maps/api";

import {
  FontAwesomeIcon,
  FontAwesomeIconProps,
} from "@fortawesome/react-fontawesome";
import { IconDefinition } from "@fortawesome/fontawesome-common-types";
import { faBus } from "@fortawesome/free-solid-svg-icons/faBus";
import { faCircle } from "@fortawesome/free-solid-svg-icons/faCircle";

import { parseBusRouteData } from "services/bus";

const testBus = [
  {
    PlateNumb: "012-U5",
    OperatorID: "200",
    RouteUID: "TPE16111",
    RouteID: "16111",
    RouteName: {
      Zh_tw: "307",
      En: "307",
    },
    SubRouteUID: "TPE157462",
    SubRouteID: "157462",
    SubRouteName: {
      Zh_tw: "307莒光往板橋前站",
      En: "307",
    },
    Direction: 1,
    BusPosition: {
      PositionLon: 121.49547,
      PositionLat: 25.015492,
      GeoHash: "wsqqk9ymc",
    },
    Speed: 37,
    Azimuth: 180,
    DutyStatus: 1,
    BusStatus: 0,
    GPSTime: "2021-11-28T14:14:27+08:00",
    SrcUpdateTime: "2021-11-28T14:22:00+08:00",
    UpdateTime: "2021-11-28T14:22:02+08:00",
  },
  {
    PlateNumb: "013-U5",
    OperatorID: "200",
    RouteUID: "TPE16111",
    RouteID: "16111",
    RouteName: {
      Zh_tw: "307",
      En: "307",
    },
    SubRouteUID: "TPE157462",
    SubRouteID: "157462",
    SubRouteName: {
      Zh_tw: "307莒光往板橋前站",
      En: "307",
    },
    Direction: 1,
    BusPosition: {
      PositionLon: 121.456637,
      PositionLat: 25.015813,
      GeoHash: "wsqq7cfp8",
    },
    Speed: 17,
    Azimuth: 7,
    DutyStatus: 1,
    BusStatus: 0,
    GPSTime: "2021-11-28T14:21:49+08:00",
    SrcUpdateTime: "2021-11-28T14:22:00+08:00",
    UpdateTime: "2021-11-28T14:22:02+08:00",
  },
  {
    PlateNumb: "019-U5",
    OperatorID: "200",
    RouteUID: "TPE16111",
    RouteID: "16111",
    RouteName: {
      Zh_tw: "307",
      En: "307",
    },
    SubRouteUID: "TPE157463",
    SubRouteID: "157463",
    SubRouteName: {
      Zh_tw: "307莒光往撫遠街",
      En: "307",
    },
    Direction: 0,
    BusPosition: {
      PositionLon: 121.52268,
      PositionLat: 25.043747,
      GeoHash: "wsqqmr447",
    },
    Speed: 14,
    Azimuth: 102,
    DutyStatus: 1,
    BusStatus: 0,
    GPSTime: "2021-11-28T14:21:47+08:00",
    SrcUpdateTime: "2021-11-28T14:22:00+08:00",
    UpdateTime: "2021-11-28T14:22:02+08:00",
  },
  {
    PlateNumb: "027-U5",
    OperatorID: "200",
    RouteUID: "TPE16111",
    RouteID: "16111",
    RouteName: {
      Zh_tw: "307",
      En: "307",
    },
    SubRouteUID: "TPE157462",
    SubRouteID: "157462",
    SubRouteName: {
      Zh_tw: "307莒光往板橋前站",
      En: "307",
    },
    Direction: 1,
    BusPosition: {
      PositionLon: 121.500185,
      PositionLat: 25.02444,
      GeoHash: "wsqqkg99z",
    },
    Speed: 10,
    Azimuth: 193,
    DutyStatus: 1,
    BusStatus: 0,
    GPSTime: "2021-11-28T14:21:46+08:00",
    SrcUpdateTime: "2021-11-28T14:22:00+08:00",
    UpdateTime: "2021-11-28T14:22:02+08:00",
  },
  {
    PlateNumb: "028-U5",
    OperatorID: "200",
    RouteUID: "TPE16111",
    RouteID: "16111",
    RouteName: {
      Zh_tw: "307",
      En: "307",
    },
    SubRouteUID: "TPE157463",
    SubRouteID: "157463",
    SubRouteName: {
      Zh_tw: "307莒光往撫遠街",
      En: "307",
    },
    Direction: 0,
    BusPosition: {
      PositionLon: 121.568345,
      PositionLat: 25.051397,
      GeoHash: "wsqqw27qg",
    },
    Speed: 0,
    Azimuth: 97,
    DutyStatus: 1,
    BusStatus: 0,
    GPSTime: "2021-11-28T14:21:52+08:00",
    SrcUpdateTime: "2021-11-28T14:22:00+08:00",
    UpdateTime: "2021-11-28T14:22:02+08:00",
  },
];

const lat = testBus[0].BusPosition.PositionLat;
const lng = testBus[0].BusPosition.PositionLon;

const position = {
  lat,
  lng,
};

const testRoute = {
  RouteUID: "TPE16111",
  RouteID: "16111",
  RouteName: {
    Zh_tw: "307",
    En: "307",
  },
  SubRouteName: {},
  Geometry:
    "LINESTRING (121.565469159085 25.0659044522788, 121.565699938744 25.0643429397675, 121.565915415465 25.0631358669526, 121.566078299969 25.062543914675, 121.566324601363 25.0617213565145, 121.566521653864 25.0612870468439, 121.566711983282 25.0610255035546, 121.567575709733 25.0600799177175, 121.568221406227 25.0593761019904, 121.568302402778 25.0592804394836, 121.567066571821 25.0592096824229, 121.564560288889 25.0590106215647, 121.56396638298 25.0589595112922, 121.563627856613 25.0591760573006, 121.563455623899 25.0592244774737, 121.563274482597 25.0592190974555, 121.56312600612 25.0591303271196, 121.563078493647 25.0590550067841, 121.563042859293 25.0589796864024, 121.563039889763 25.0588505656402, 121.563054737411 25.0587483449404, 121.563212122477 25.058560043428, 121.563381385661 25.058428232202, 121.56351501449 25.0572311645289, 121.563862449446 25.0542155781928, 121.563811967444 25.0533587722864, 121.563764454971 25.051489112231, 121.560756321546 25.0515698175705, 121.558077306131 25.0516443302517, 121.554850315056 25.0517066889202, 121.551672795342 25.0517792660346, 121.548360938996 25.0518109023033, 121.545164519247 25.0519071338498, 121.541819543648 25.0519803174225, 121.538864729779 25.0520326631342, 121.536951831584 25.0520846210283, 121.533415244114 25.052106534789, 121.530357749248 25.0521531206804, 121.527832641391 25.0521650904734, 121.525379160517 25.0521942249305, 121.523634517329 25.0522599746928, 121.522430627652 25.0523145073238, 121.522324681069 25.0517586780888, 121.522163740841 25.0513419313754, 121.521971805467 25.0509316201225, 121.521472862542 25.049855444429, 121.520687558325 25.04821777277, 121.520250326171 25.0473768759509, 121.520057090424 25.0469799720613, 121.519800117066 25.0464019053128, 121.519517266825 25.0457933830077, 121.517509786592 25.0462821751295, 121.51637525559 25.046572019171, 121.513240057364 25.0473258833179, 121.512500802868 25.047504, 121.512237418926 25.0475705885168, 121.512004087411 25.0476979453601, 121.511861978205 25.0478107022688, 121.511475393628 25.0480796242471, 121.511187864852 25.0481584466676, 121.509946265742 25.0482319267204, 121.509684946277 25.0472783056709, 121.509121909338 25.0455510736229, 121.508514074428 25.043340226086, 121.507911714259 25.0412309966567, 121.50725016845 25.0390678909448, 121.506775522957 25.0374395177093, 121.506658274757 25.0371315439911, 121.506407451627 25.0360927822244, 121.506323618266 25.0357488555863, 121.506156283177 25.0353645170876, 121.505625340038 25.0346170747733, 121.505665080741 25.0344856985984, 121.505711142381 25.0343192956105, 121.505690540413 25.0341867487402, 121.50548169988 25.0338066502349, 121.50522860325 25.0333736591855, 121.504901404569 25.0327701062308, 121.50440076392 25.0318466210207, 121.504091758844 25.0313057293559, 121.504109576021 25.0300949436436, 121.50049268904 25.0294384237286, 121.500424098409 25.0276902535629, 121.500402422945 25.025740936993, 121.500375936525 25.0250337030464, 121.500294014341 25.0245574200563, 121.500125625138 25.0240701733997, 121.499941 25.023697, 121.498383233599 25.0212294074597, 121.496844299656 25.0186981936216, 121.495633634418 25.016738, 121.495515451627 25.0164727365711, 121.495492001556 25.0162222545722, 121.495447419365 25.0137410790661, 121.495388710183 25.0113699183555, 121.495335197132 25.007057, 121.495354937528 25.0067054709854, 121.495585014341 25.0061182885239, 121.496287577055 25.0045505895245, 121.496403229399 25.0042656873733, 121.496490648759 25.0038447132715, 121.496617604 25.0026821119146, 121.496732201146 25.0016393090107, 121.496781182791 25.0013291257264, 121.496910272392 25.0010433697317, 121.497079788527 25.0008505723697, 121.496234848228 24.9996237107439, 121.495764591395 24.9989408931984, 121.495633545578 24.9987362476581, 121.495508182791 24.998597359311, 121.493016211473 24.996920086799, 121.492138045653 24.9966707745099, 121.491482207832 24.9965390866788, 121.490492444412 24.9964109916581, 121.48965469156 24.996335173246, 121.489048125427 24.9963091066547, 121.486092363645 24.9963124926261, 121.483742401323 24.9962624466742, 121.483602759845 24.9961844466727, 121.482966605736 24.9957598271526, 121.482501162126 24.9955617094515, 121.480999225814 24.9951297664974, 121.481207810801 24.9963885638554, 121.481269605736 24.9969146600329, 121.48131649452 24.9975396299507, 121.481327150441 24.9983839740737, 121.481296713017 25.000599890266, 121.481292451627 25.0026999545059, 121.481249365174 25.002954818286, 121.480838790731 25.0038613385232, 121.480328270322 25.0050586642806, 121.48011028224 25.0055590753752, 121.480015931982 25.0058870655803, 121.479993967681 25.0060524306287, 121.479794524945 25.0061024156557, 121.479549845891 25.0061286784622, 121.479230952452 25.0061066171818, 121.478973634418 25.006028499229, 121.478576147224 25.0058792461207, 121.477983534032 25.0057425712683, 121.477348591395 25.0056890353867, 121.476553985659 25.0058380353119, 121.475226300901 25.0060709757249, 121.473982793868 25.0062213846228, 121.472878956977 25.0063790175154, 121.471401996359 25.0066257307047, 121.470754817209 25.0067756956994, 121.468297575581 25.0076515739772, 121.464974901034 25.0088530867562, 121.465401773292 25.0097744469282, 121.465484233872 25.0099185733819, 121.465599434461 25.0099840962842, 121.46473925882 25.0115355018168, 121.464334122023 25.0122590000457, 121.463901590442 25.012571143027, 121.463423261837 25.0128818868922, 121.463268280304 25.0129941019437, 121.462806775014 25.0125314497439, 121.46209871939 25.0130095795563, 121.462050452136 25.0130745283215, 121.462036817484 25.0131263623245, 121.462036254679 25.0131909874889, 121.462047632766 25.0132422716311, 121.462362645285 25.013619073944, 121.461357012838 25.0142855797916, 121.460412382659 25.01309922236, 121.459921024837 25.0124970005193, 121.459453538511 25.0119173269937, 121.45900217116 25.0114066661924, 121.457925731164 25.0103632148883, 121.457817139768 25.0104385867053, 121.456893941766 25.0111356928059, 121.456248352101 25.0116005348013, 121.456102248955 25.0116653307396, 121.456163791076 25.012069668692, 121.456262617213 25.012758825053, 121.456533188085 25.0148753544664, 121.456803211473 25.0163945839873, 121.456516758416 25.016990418626, 121.455542593201 25.0191232968248, 121.454783756487 25.0207282116617, 121.454381562714 25.0215688782548, 121.454323591395 25.0217395404177, 121.454282577055 25.0219754727631, 121.454290534032 25.0224901081244, 121.4543163369 25.0229307038446, 121.454378 25.023806, 121.454419014341 25.0244088094677, 121.454485408302 25.0253690638214, 121.454570121474 25.0254142017946, 121.454601717149 25.0257380780854, 121.45463777773 25.026028713345, 121.454703762814 25.0263320982051, 121.454813980949 25.026580487996, 121.454514231492 25.0267495594727, 121.454178664761 25.0269653113357, 121.453795789862 25.0272452726277, 121.453568232577 25.0274714613825, 121.451499024817 25.025790178357, 121.451097429772 25.0254297379805, 121.450371707074 25.0247262782934, 121.449736501003 25.0240706154651, 121.449612338429 25.0238831636477, 121.451398695798 25.0229192424189, 121.451477117618 25.0230348564467, 121.451434005399 25.0230595707602, 121.451380767518 25.0229867521958, 121.4497459331 25.0238679665843, 121.449863292799 25.0240396275687, 121.450435111923 25.0246257292665, 121.451192487462 25.0253676796229, 121.451587652842 25.0257034482759, 121.452737684416 25.0266514807805, 121.454414033268 25.0254093393034, 121.454283833172 25.0238039524784, 121.454227519691 25.022948216301, 121.454196491009 25.0219419190871, 121.454280126107 25.0215690207777, 121.454688278222 25.0207155529906, 121.455450734708 25.0190989570838, 121.456447264527 25.0169435781127, 121.456723942636 25.0163902305464, 121.456459011347 25.0148936217858, 121.456318750789 25.013711008418, 121.456198340139 25.0127679664554, 121.456094351241 25.0120127754145, 121.455870423828 25.0119748851745, 121.455616704184 25.0118775126225, 121.455180726482 25.0115829333361, 121.455313145987 25.0114136519149, 121.455975928538 25.0115607338587, 121.456053561353 25.0116112070505, 121.456229119171 25.0115469685993, 121.456860993323 25.0110877021273, 121.457800591395 25.0103660909458, 121.457888408605 25.0102941818523, 121.457801351241 25.009927, 121.457740308218 25.0096971149454, 121.457678914785 25.0094560299731, 121.457979256386 25.0094664603857, 121.4585273227 25.0090992414741, 121.45905404171 25.0087516363905, 121.459143231553 25.0088680642674, 121.459159526249 25.0090953195754, 121.459134966683 25.0094379850042, 121.458662875117 25.00948213141, 121.458012860232 25.009535337615, 121.457765224523 25.0095168032235, 121.457859477128 25.0099069154128, 121.457968586127 25.0103069521669, 121.458335158777 25.0106373223846, 121.459048261555 25.0113804776434, 121.459499244509 25.0118593796665, 121.459960279536 25.0124548883524, 121.46044386001 25.0129845423491, 121.461429331793 25.0141484397108, 121.463259934507 25.0129131117223, 121.46230172541 25.0135578765341, 121.462124062591 25.0133312612818, 121.462132851897 25.0132530340533, 121.462147226351 25.0132278677743, 121.462983729599 25.0126775064312, 121.463254071071 25.0129261522026, 121.463420404674 25.0128289729161, 121.463962766714 25.0124891889042, 121.464301032151 25.0122366175663, 121.464668237541 25.011492718574, 121.465511230737 25.0100068953705, 121.465434146306 25.0099620656914, 121.465320829242 25.0098200739422, 121.464877826378 25.0088065661363, 121.468125009537 25.0076064506199, 121.470706154109 25.0066913216848, 121.4712340214 25.0065568030167, 121.472167806287 25.0063870175131, 121.473952414155 25.0061013763581, 121.475181934839 25.0059248861535, 121.476462421076 25.0057077905832, 121.477337591395 25.0055856430644, 121.477992548373 25.0056395182185, 121.478407205765 25.0057267474972, 121.478960648759 25.0058903039532, 121.479255009726 25.0059783673659, 121.479525860232 25.0059929296239, 121.479764717594 25.0059680340042, 121.479950437286 25.0059038223377, 121.480030046514 25.0055432597887, 121.480229506736 25.0050484688829, 121.480761258136 25.0038476199237, 121.481172765845 25.0029457660925, 121.481224944757 25.0026849482058, 121.481219593866 25.0005932145095, 121.481252985659 24.9983885467029, 121.481226368539 24.9975501107391, 121.481176327357 24.9969291645726, 121.481116484585 24.9964093173006, 121.480904154109 24.9950040047969, 121.481919008134 24.9952870530416, 121.482490505547 24.9954495870406, 121.483046874573 24.9956774466879, 121.483779508991 24.9961644466765, 121.484190379923 24.996179046432, 121.486134260408 24.996200049235, 121.489046899614 24.9962125997823, 121.489694537451 24.9962410264314, 121.490620514083 24.9963092204477, 121.491536616437 24.9964277066356, 121.492195967072 24.996564099459, 121.492664981983 24.9966786187229, 121.493046028682 24.9968153869028, 121.495566379923 24.998524, 121.495880946338 24.9988630037874, 121.49632661318 24.99959916167, 121.497204225814 25.0008612516418, 121.496996199004 25.0010996773644, 121.496888422945 25.0013460187841, 121.496843605736 25.0016848235299, 121.496713774469 25.002678331787, 121.496582268836 25.0038683557916, 121.496467477746 25.0042934468753, 121.496388802868 25.0045562501974, 121.495698390623 25.0061458533185, 121.495459784798 25.0067159870236, 121.495414 25.007047, 121.495448408605 25.0091102688042, 121.495496357169 25.0113112740067, 121.495525549977 25.0137309130818, 121.495603041889 25.0162153044781, 121.495610465968 25.0164533205269, 121.495716240154 25.016692, 121.496348225814 25.0177443235739, 121.49692906331 25.0186723754082, 121.498496620077 25.0212005540255, 121.500032605736 25.0236811081915, 121.50022001893 25.0240654107377, 121.500382240155 25.0246005541206, 121.500467205362 25.0251129579512, 121.500479240155 25.025697662456, 121.500539459857 25.0276973289558, 121.500599225814 25.0293704842069, 121.500603252958 25.0293478648949, 121.501626217545 25.0295663338445, 121.502523611952 25.0296978797641, 121.503435874238 25.0298799413058, 121.504169766066 25.0299846648981, 121.504169519691 25.0312872587086, 121.504470408605 25.0318322172995, 121.504955 25.032735, 121.505281636476 25.0333345147252, 121.505526108327 25.0337534516319, 121.505808409475 25.0342568763805, 121.506211950878 25.0349843876083, 121.506381437286 25.0353911973593, 121.506538076883 25.0357531215808, 121.50663443228 25.0361533703331, 121.506938936334 25.0371962650954, 121.507467349809 25.0389787367168, 121.508012548373 25.04085578169, 121.508490391165 25.0425006932501, 121.508725929134 25.0433257187656, 121.509308873878 25.0454039747768, 121.509436132177 25.045956934874, 121.509595942636 25.0464781094722, 121.50989807989 25.0470889238328, 121.510285754437 25.047677483936, 121.51056185911 25.0480392557188, 121.510902666511 25.0480571061622, 121.511350322851 25.0479618330943, 121.511762353999 25.0477122434784, 121.512166067462 25.0474954302824, 121.513204605736 25.0471775403681, 121.51699925671 25.0462381545293, 121.518106447987 25.0459445397135, 121.519581759845 25.0455579696153, 121.519964108322 25.0455255683255, 121.520568139768 25.0453826411924, 121.521603408605 25.0451480939898, 121.521275182791 25.0440478826734, 121.522994577055 25.043597429149, 121.523580025041 25.0456153378213, 121.524080437286 25.0472823285527, 121.524247014341 25.0479436643312, 121.524525600123 25.0489843685454, 121.524629665333 25.0491573003101, 121.524975136127 25.050398013905, 121.525420265196 25.0520084391308, 121.527850422502 25.051992999999, 121.530353386538 25.0519825608814, 121.533411498765 25.0519258226327, 121.536958010478 25.0519032255591, 121.538868644512 25.0518746423175, 121.541812050795 25.0518187990363, 121.54333 25.05179, 121.545105626693 25.0517485669932, 121.548372046983 25.0516588668177, 121.551668964037 25.051607012181, 121.554871104965 25.0515444839107, 121.558081709541 25.0514593414959, 121.56089486823 25.0513893168971, 121.563817906503 25.0513303915749, 121.563877297094 25.0532995892397, 121.56390402286 25.0540945227765, 121.563806028385 25.0553454229786, 121.563604100376 25.0570885916453, 121.56348383443 25.0584793426913, 121.563610039435 25.0585627334517, 121.563719912028 25.0586622642849, 121.563856510387 25.0588586356919, 121.568459281176 25.0592244774737, 121.56835033672 25.0594179026241, 121.567693186492 25.0601444583235, 121.566812796485 25.0610700279668, 121.566646850313 25.0613138125388, 121.56643251633 25.0617787276528, 121.566189636038 25.0625750767667, 121.566007856667 25.0632508753565, 121.56581768141 25.0643877058593, 121.565581532305 25.0659343933162, 121.565472182791 25.0659071130305, 121.565441051738 25.0659440545497, 121.565758988869 25.063819799935, 121.566103629989 25.0624518101367, 121.5663138463 25.0617520145103, 121.566567523973 25.0612335477992, 121.56680249331 25.0609016093117, 121.568265916801 25.0593309650595, 121.568430508777 25.0591972205265, 121.568597678136 25.059025091128, 121.568784981381 25.0588226851866, 121.568950175769 25.0585668400251, 121.569069678655 25.0583750293243, 121.569194170745 25.0576614307519, 121.569594585776 25.0553078625571, 121.569711754095 25.0543885983439, 121.569884028407 25.0529840740346, 121.570153971318 25.051413219512, 121.569986985659 25.0514102379216, 121.569691154109 25.0514130122734, 121.567574422945 25.0514671219883, 121.567328985659 25.0514172440753, 121.564408615297 25.0514796732353, 121.56094481661 25.0515162500931, 121.558973971318 25.0515993536554, 121.557700179975 25.0516383919575, 121.556424702482 25.0516550121462, 121.554806408358 25.0516890621781, 121.551707083459 25.0517495859905, 121.548414380026 25.0517895036994, 121.545381282733 25.0519071338563, 121.542523160503 25.0519732151072, 121.539610180003 25.0520285020942, 121.537041425011 25.0520702304019, 121.53387541028 25.0521035268111, 121.530973813893 25.052132086093, 121.528145219072 25.0521349375711, 121.525299942248 25.0521897382551, 121.523546702482 25.0522696883994, 121.522428721296 25.0523129122856, 121.522374398152 25.052032640861, 121.522240520534 25.0515121976767, 121.521965072961 25.0509378119743, 121.52078731235 25.0484225660896, 121.520549076999 25.047968971307, 121.519978487689 25.0468036348744, 121.519518212208 25.045823566827, 121.518782402399 25.0459645417929, 121.517160754855 25.0463644285825, 121.514624682137 25.0469898061385, 121.513164 25.04735, 121.512497 25.047504, 121.512140588499 25.0476755560195, 121.511927777655 25.0477493127203, 121.511767857335 25.047861124838, 121.511483735549 25.048092665405, 121.511212920091 25.0481742196961, 121.510974422945 25.048194260938, 121.510696659459 25.0482274869866, 121.510183064717 25.0482443296003, 121.510058819335 25.0482352471925, 121.509904692139 25.0482157549998, 121.509510014341 25.0468855474716, 121.509109062185 25.0454710980167, 121.508530567814 25.0434705746571, 121.507792066536 25.0408785189148, 121.5071246738 25.0386888884083, 121.506810396961 25.0375886400388, 121.506498554293 25.0364010901358, 121.506411254495 25.0360376533222, 121.506080225814 25.0351819014039, 121.505844142745 25.0348354577832, 121.505587887176 25.0345946132109, 121.505657728048 25.0344666145513, 121.505706504754 25.034296065816, 121.50549388407 25.0338537791766, 121.504907945583 25.0327623854018, 121.504099 25.031297, 121.502950600639 25.0312839896485, 121.50051301515 25.0312065853769, 121.500469182791 25.0294742946939, 121.500425807825 25.0271667673776, 121.500394817209 25.0256685742141, 121.500362400834 25.0249839952134, 121.500297248697 25.0247122453001, 121.500183731164 25.0243093164442, 121.500090586892 25.0239995611941, 121.499941 25.023697, 121.499432905103 25.0228847251574, 121.498611409518 25.021595744883, 121.49787411755 25.0204111298762, 121.496423915139 25.0180550694573, 121.495633634418 25.016738, 121.49555248942 25.0165595458265, 121.495496437286 25.0163211077785, 121.495442239097 25.0140270061174, 121.495398844306 25.0114735193581, 121.495355384571 25.0089162111462, 121.495312379923 25.0070673391141, 121.495342852501 25.0068650388521, 121.49539123344 25.0065815233511, 121.495459519691 25.0063802144421, 121.496329408605 25.0044988928855, 121.496479240155 25.0039584464573, 121.496512639556 25.003789138172, 121.496608605187 25.0024755550074, 121.496788788527 25.0012705346741, 121.4968974541 25.0010555777904, 121.497056971318 25.0008540189112, 121.495599451627 24.9987076507432, 121.494901583618 24.998187029795, 121.493008605736 24.9969200867969, 121.492257992941 24.9967010798854, 121.491518258527 24.9965411037733, 121.490594 24.996411, 121.489755294039 24.9963283630038, 121.489067139768 24.9962808050201, 121.48723324317 24.9962611393119, 121.484179731164 24.9962865733898, 121.483751071704 24.9962671668758, 121.482932379923 24.9957632738393, 121.482383317263 24.9955196950836, 121.481653650047 24.9953257403876, 121.481003028682 24.995129766483, 121.481284817209 24.9970525261726, 121.481326196216 24.9979705084226, 121.481324355139 24.9990078926904, 121.481296946871 25.0010998274348, 121.481342914938 25.0026742366744, 121.48130486461 25.0029283331294, 121.480678079436 25.0042401481423, 121.48031466612 25.0050731299831, 121.480086208608 25.0056376323189, 121.479966494695 25.0060628320585, 121.479707571909 25.006124168375, 121.479523225814 25.006118339196, 121.479259615086 25.0060980894993, 121.479019268836 25.0060388384404, 121.478036774186 25.0057735889163, 121.47765282085 25.0057097138395, 121.477314559295 25.0057070718389, 121.476684257891 25.0058053585163, 121.475954554567 25.005925794803, 121.472837125427 25.0064031422457, 121.471691014341 25.0065705885712, 121.471320470171 25.0066594524777, 121.470827073028 25.0067638957676, 121.470074103805 25.0070203883558, 121.467597977377 25.0078976161876, 121.464955513085 25.008872062294, 121.46540971739 25.0097922770925, 121.465479613667 25.009909488681, 121.465602867585 25.0099725706439, 121.465522538408 25.0100971606954, 121.464409880189 25.0121369828251, 121.46429898948 25.0122872605765, 121.464086226045 25.0124528942875, 121.463262593135 25.0129811114631, 121.462812309579 25.0125309964822, 121.462113527364 25.0130000154906, 121.462053971901 25.0130714971302, 121.462038516607 25.0131286524318, 121.462036643087 25.0131879956554, 121.462044408698 25.0132335064549, 121.462361100961 25.0136099323084, 121.461365018161 25.0142752398094, 121.459994579012 25.0126094281874, 121.459958100278 25.0125321521663, 121.459898350591 25.0124658136736, 121.459493198559 25.0119748554278, 121.459203212121 25.0116278715399, 121.458330514676 25.0107548226546, 121.457971365582 25.0103942313871, 121.457936 25.010362, 121.457801928296 25.0104833882962, 121.456261643235 25.0115876613616, 121.456106246325 25.0116758011441, 121.456268989003 25.0127329563787, 121.456371453263 25.0137924323585, 121.456562125679 25.0150933997999, 121.456803211473 25.0163911377591, 121.456450565134 25.0171207376091, 121.455887968974 25.0183665888108, 121.455260140923 25.0197362053637, 121.454819127146 25.0206641540984, 121.454533126994 25.0212701712507, 121.454403185822 25.0215123702875, 121.454316372838 25.0217358891216, 121.454274154109 25.0219738654088, 121.454374197132 25.0237474196714, 121.454422817209 25.024484708062, 121.454502594071 25.0253786943112, 121.454563561074 25.0254245090551, 121.454623268042 25.0259327294755, 121.454658649834 25.0261923751307, 121.454730620109 25.0264135178781, 121.45481963755 25.0265785434341, 121.454365546529 25.0268353206361, 121.454003658879 25.0270857111105, 121.453714079611 25.0273225255265, 121.453544831976 25.0274770193755, 121.452388161813 25.0265158324402, 121.451604290476 25.0258714288294, 121.451149918826 25.0254851110581, 121.450290143316 25.024654507283, 121.449838906619 25.0241916184713, 121.449612945459 25.0238870761559, 121.451397719021 25.0229241753941, 121.451449067962 25.0229996184133, 121.451410513082 25.0230187665523, 121.451383610424 25.0229770322754, 121.449767339634 25.0238690959849, 121.449939060196 25.0241078472857, 121.45038848774 25.0245834351937, 121.451219305839 25.0253733606189, 121.451712394383 25.0257873068446, 121.452262365351 25.026235734631, 121.452743857335 25.0266402796442, 121.453597774598 25.026012823252, 121.454409371229 25.025411063738, 121.45434128901 25.0245569255277, 121.454284562714 25.023764897793, 121.454188983657 25.0219660407533, 121.454230525881 25.0217330695505, 121.454326745558 25.0214956205531, 121.454450791906 25.0212552086986, 121.454741215373 25.0206407740383, 121.455184621307 25.0196936058746, 121.455806321467 25.0183347557459, 121.4563775226 25.0170720264913, 121.456731548373 25.0163488772399, 121.45649254039 25.0150888794787, 121.456300694331 25.0138134488984, 121.456205596852 25.0127849305453, 121.456067534394 25.0120131203913, 121.455844741415 25.0119775020058, 121.455624847126 25.0118922056364, 121.455340647128 25.011693524248, 121.4551739524 25.0115636178569, 121.455310850138 25.011410193335, 121.455584594617 25.0114772040096, 121.455823082805 25.0115240678856, 121.456010228401 25.0115598396733, 121.456109922488 25.0116115170472, 121.45627368879 25.0115092273354, 121.457773971318 25.0103936611682, 121.457823759845 25.0103355372124, 121.457860774186 25.0102694132359, 121.457867971318 25.0102170743744, 121.457791954857 25.0098971765567, 121.457659900444 25.0094663688833, 121.457937424836 25.009473352993, 121.458766903395 25.0089407109208, 121.459046435974 25.0087516365722, 121.459127862724 25.0088554185188, 121.459155723381 25.0090677490538, 121.459138769551 25.0094379850044, 121.45842709729 25.0094993629105, 121.457933 25.0095249987074, 121.45777283026 25.0095202495241, 121.457870885733 25.0098793450793, 121.457968586127 25.0103103984463, 121.458399807536 25.0107131403024, 121.459259745525 25.0115798700915, 121.459554059808 25.0119337304629, 121.459931817209 25.0124174302372, 121.459998789708 25.0124806864994, 121.46006750535 25.0125520120366, 121.461444014341 25.0141734772798, 121.46324947606 25.0129360882946, 121.46231682386 25.0135776699518, 121.462125424116 25.0133259332073, 121.462132939394 25.0132434792072, 121.462187671216 25.0132027146483, 121.462979377869 25.0126821598833, 121.463252176097 25.0129348525638, 121.463839046431 25.0125657767936, 121.464243301049 25.0122662806908, 121.464365488359 25.0121055151183, 121.465507346554 25.0100519258501, 121.465413980291 25.0099844157248, 121.465342394856 25.0098764420683, 121.465292026912 25.0097530989683, 121.464847403433 25.0087824418382, 121.467560544236 25.0078226714393, 121.470116709541 25.0068981044214, 121.47090565223 25.0066383300848, 121.471307446125 25.0065376392785, 121.471690365582 25.0064568578022, 121.472780068064 25.0062905185578, 121.475975338033 25.0057995722848, 121.476643093133 25.0056827405686, 121.477303365582 25.0056097679426, 121.47766872559 25.0055983994031, 121.478076211473 25.0056601966758, 121.479017691782 25.0059351071926, 121.479280989384 25.0060000796914, 121.479483197884 25.0060073252802, 121.479765440927 25.0059791440989, 121.479931422945 25.0059210543614, 121.480024977164 25.0055395752277, 121.480228915444 25.0050585776988, 121.480609143409 25.0042198371889, 121.48124896722 25.0028574548127, 121.481219279513 25.0010998502221, 121.481241091032 24.9990008670966, 121.481203548373 24.9970409131744, 121.480915562714 24.9950040048014, 121.481701369326 24.9952094448838, 121.482458671288 24.995415869783, 121.483043071704 24.9956705533095, 121.483798523332 24.9961678933542, 121.484197985659 24.9961824931166, 121.48718322219 24.9961339032429, 121.489085330047 24.9961383989638, 121.489750996443 24.9962250127331, 121.490573 24.9963134065836, 121.491578447987 24.9964242599536, 121.492329503172 24.9965799076895, 121.493027014341 24.9968188335712, 121.494973208789 24.9981226270958, 121.495699480309 24.9986515245303, 121.497215634418 25.0008750378197, 121.496997059885 25.0010986141118, 121.496892225814 25.0013012138708, 121.496739836865 25.0025239802038, 121.496607251095 25.0037855172338, 121.496567057364 25.00395796377, 121.496392605736 25.0045321250956, 121.495575921486 25.0064307011241, 121.495494540292 25.0066187968043, 121.495435895355 25.0068607515879, 121.495414 25.0070711245975, 121.495437 25.008910382454, 121.49550065952 25.0114872543717, 121.495527331391 25.0140135458574, 121.495591451627 25.0162293233174, 121.495624617251 25.0165008857494, 121.49570483155 25.016692, 121.496511753702 25.0180252075015, 121.49792618985 25.0203218274877, 121.498720786413 25.0215450486563, 121.499526008966 25.0228364023941, 121.500025 25.023688, 121.50015668457 25.0239495582795, 121.500279562714 25.0242973164097, 121.500390904441 25.0246938446608, 121.500456408364 25.025020410365, 121.500498254495 25.0257045541523, 121.500528051252 25.02720457975, 121.500572605736 25.0294704107438, 121.500603514395 25.0311365883333, 121.504096788527 25.0312234096205, 121.504095797346 25.03009921722, 121.502483351233 25.0298197536611, 121.50057346279 25.0294890970466, 121.500572156504 25.0293453730454, 121.502545858384 25.0296974002167, 121.504159197132 25.0299988816698, 121.504169519691 25.0312769216471, 121.504490226448 25.031846, 121.505001839672 25.0327453369512, 121.505546755815 25.0338010909039, 121.506120219317 25.0347881640958, 121.506212310717 25.0349967903323, 121.506217142048 25.0351021119357, 121.506423268836 25.0354601088534, 121.506644232922 25.0360693150135, 121.506731825126 25.0364425136034, 121.506842480756 25.0368760418606, 121.507060017179 25.0375570933912, 121.507370211633 25.038530300757, 121.508016351241 25.0408385545776, 121.508731787963 25.0432903898467, 121.509354508296 25.0454384277183, 121.509645379923 25.046485, 121.509934117024 25.0473004039887, 121.510551029936 25.0480179326529, 121.510912020539 25.0480669605265, 121.511427996206 25.0479565958339, 121.511681116485 25.0477696386806, 121.512445391387 25.0474252207135, 121.513223620077 25.0471672046399, 121.514559079366 25.04683821628, 121.51711770226 25.0462063806791, 121.518813580473 25.0457577962844, 121.519590862999 25.0455568471685, 121.519933060782 25.0455376793757, 121.521599605736 25.0451446486844, 121.521298 25.0440444373415, 121.52298316845 25.0435939838, 121.523541996359 25.0455464319293, 121.523810433646 25.0463314381729, 121.524250817209 25.0479436643308, 121.524552327922 25.0490234561984, 121.524634612865 25.0491787537871, 121.524956121787 25.0503598354172, 121.525435476668 25.0520222195687, 121.528131834747 25.052010225547, 121.530970088701 25.0519492670108, 121.533023 25.051955, 121.533879347985 25.0519319882129, 121.537003644896 25.0518963353349, 121.53961385978 25.0518531813013, 121.542531397682 25.0518037804591, 121.545382727038 25.0517432621348, 121.547722 25.05169, 121.54840260057 25.0516746055715, 121.551695584114 25.0516001219433, 121.554802658977 25.051555628024, 121.556399656672 25.0514837387068, 121.557560716601 25.0514731219914, 121.558993262363 25.0514334905964, 121.560891029614 25.0513809888435, 121.564370780243 25.0513213372324, 121.565667078542 25.0512733415574, 121.567295007871 25.0512849512185, 121.567478182791 25.0511897743498, 121.569585813568 25.0511396646, 121.570322817209 25.0511331947505, 121.570403451627 25.0513268351562, 121.570205770759 25.0530164930605, 121.569931388929 25.0545499067131, 121.56976570165 25.0554269639586, 121.569352130966 25.0576953465403, 121.569212344308 25.0584392498175, 121.569056095528 25.059306353909, 121.568679251888 25.0592808350456, 121.568472623775 25.0592977414466, 121.568326881913 25.0594262505914, 121.5668813578 25.0609897001079, 121.56665851062 25.0612644647806, 121.566422336716 25.0617626946302, 121.566237642366 25.0624619067147, 121.565898219729 25.0638219091523, 121.565572204941 25.0659587582086, 121.565425958063 25.0659379372484)",
  EncodedPolyline:
    "{t~wCeg~dVvHm@nFk@vB_@bDo@tAg@r@e@|DmDjC_CROLtFf@tNHtBk@bAG`@?d@PZLHNFX?RAd@_@Xa@nF[xQcAjDHtJHOvQMvOMdSMzREtSS~RMzSInQI|JE`UGbRCxNChNM|IInFlBTrA^pAd@tEbBfIzCfDvAnAd@rBr@xBv@aBpKy@`FwCrRa@rCMr@Yn@UZu@jAOx@MvF|Dt@xInBxLxBdLvBnLbCdI|A|@VnEp@bAPlA^rChBXG`@GXBjAh@vAp@vB`AvDbBjB|@rFC`CrU|ILdKBlCB|AP`B^hAd@lNvHxNrHfKpFt@Tp@DnNFxMJ|YHdAAtBo@xHkCv@UtAQfFYnEU|@Ix@Yd@a@tFhDfC|Af@XZVnIpNp@nDXbCXdELfDDvB?nQHtMNZrA|Bf@|AtAjH{Fi@gBK}BIgDA{LDcL@q@FuDpAoFdBcBj@aAP_@DIf@En@B~@Nr@\\lAZvBH|B]~Cm@fG]xF_@zEq@fH]`CmDhNoFxSwDuA]OKWwHjDoCpA}@tA}@~AU\\zAzA_BlCKHK@K?IAkA}@eCfElF|DvB`BrB|AdBxApEtEOTkCxD{A~BM\\oAKiCSgLu@mHu@wBv@iLbEaIvCgDnAa@Jo@FeBAwAEoDKwBG_EMGOaAEy@G{@Kq@Ua@z@k@`Aw@jAk@l@nI|KfAnAjCpCbC|Bd@X~DeJUOEHLHoDdIa@UuBsBsCuCaAoA}DeFvFmI`IXhDHhEDhAOhDqAbIwCnLgElBu@jHr@jFZzDVvCTFj@Pp@z@vA`@Y]eCIMJc@zA}BnC{DNQfAPl@Jn@JA{@hAmBdAgBWQm@CcADG|AK`CBn@mAQoAUaAiAsCmC_ByAuB{AiB_BiFeEvFmJaC~Dl@b@NABClBeDq@u@Ra@bAkBp@cAtCiAfHgDHNZThEvAnFiSvDcOXgB`@{Dx@cJb@uFh@_GVoDIaCQsA_@mBQ{@Au@Bm@Le@fAO`Bg@nFiBrDqAt@I`L?vLEfDBzBHfBJxGj@y@kE_@qBm@oB_BqCCqACcKAgQE_CMyDWwDYcCW{A[mAsIwNcA}@sCyA{FmDo@f@q@TaAHgEXmFXsATu@N}HhCqBn@aAH{KGwLIcNEqNMm@Ao@UqE}ByDsByNyHoNqHmAe@iB_@eBQuBAoKKmIKB?k@mEYqDc@wDSqCeG?kB{@uDaBuB_AsAq@eBw@oCoAqAa@gA_@oAQqE}@cJiBwJkBgI_BeDo@}KsBoBYgB_@yB{@uBmAgAu@CcARyAp@qAh@qA~@mEzDwVz@}EjAeHDkA\\yBl@mEzE~@xAuIsKuBkIcBcCa@oEw@c@SwFeAaIwABeN@sNHcRDeUD}JHkQDoHFcJPkSHsSL_SNaSLqPJiQiKK}CC{FP{Ih@uGVOYSUg@[gAw[g@ToCbCyDnDo@^}Aj@_Dn@eCb@cFd@sHn@BTEDfL_ApGcAjCi@fBs@`Am@xHeHX_@`@a@h@c@p@a@d@WnCWtMoAvDWxGa@xHu@?^?z@KfLHn@KfQGtTOhKG|FC~FE`IKjRGrSW|QKzPKdQG`OEvREdQ?rPKxPO|IG~Ev@JfBXpBt@vNjFxAn@hFpBbEzA[rCoAbI}BzNgAbH]bCc@fAMh@U^m@x@Ot@Cn@Gt@AfB?VB^hGlAzGnAnKrBdOrCtLdCzE|@lF|@fAPjD`AbAn@p@p@VM`@IxAj@xErBbH`DBdFLfNzIFjMFjHFhCDt@JnAV|@Pz@\\bDdB~FbDlFrCtM`HfG|Cb@Nn@HhMJ~NF|NFpJHf@Ex@If@MvJmDjB]`@EdGSpFc@h@Uh@_@jLbHfBjC|FxJj@tC^rCXxDNdDHhCBnJE`RBtAdBbDn@lBd@pCf@`C_Kw@wDIoE@aLByHGs@FeGzBeDhAqBj@sAVKr@?d@Br@Jn@t@bEJlA?bAS|BWpC}AlRa@dFQhAS`Bs@vCoDlNaEnOwDyAWMKWYNwK|E]T_@h@iBdDxAxA}AjCMJK@K?G?kA_AeCdElIrGNDJJbBpAbAx@nDlDfAfADDWZ}ErHQ\\qE_@sEScGe@cGo@qCdAyFnBqG|BwDvAyBx@o@Xm@Nm@HcJSqCIsDOGKeBKs@Gk@Ma@Qs@xAq@hAm@x@_@`@~DdF`C|CjAxAfDjDzAxAz@l@`EeJOICFFDqD`Io@a@}AyA}CeDsAaByAmBoA_B|BkDvBaDhDL~CJdJPn@Gl@Sn@WzBy@|DwAnG}BzFqBnCeAzFn@~Fd@lEPxCZDl@Pj@f@v@X`@\\[Mu@Go@Ge@ISR_@~EkHHILGHA~@NtAX?w@hBeDd@w@UOi@EiABKlCCbB?^gASuASoAuAmDkDeAy@aBkAKMMMcIqGtFiJ_CxDp@d@P?FKfB}Cq@u@fAuBz@oA^YzKcFLRRLXH`EvA~D}OvD_Or@}CRoANkA`@yE`B_SVcCLcC@iAKqAw@{DKs@Ag@Dy@J_@jAQ~Ai@fDkAnG_C~IDbLCfKFvKv@i@{Ci@wCq@sBcBwCAoAHsQA}JQcCOcDUiE_@uCo@kCcGcKiBqC}LoHk@j@g@TsF\\}FXa@FqBb@{J`De@Po@Hi@DoJEcOKwNE{LKu@Ee@OkGaDiM{GuF}CaGaDiDaBs@[eAWmAUaAMgCGkHEeMGmIEO{T~E?v@bI`A|JZ?eAkK{@aI_GAqB_AsDeBqEmBeEqBi@QSAgAg@yBk@iAQwAUgCk@aE}@mMaCiNmCmL{BoE{@cDw@oC{BIgATgBd@q@bAyCr@yC`AkG|B_OxAqIf@{CBcAnAmIzEz@xAoIgKoB{Cu@aIwAwE{@_@OkFaAkI_B@yOJwPAyKDkDDoRHiOHgQJyPHsMBgCLsSFkRN_I@gFF}GH{JJwTHcGAeIPc@HeL@qCg@OqId@qHv@oD^eMrAsCZmD\\DjACh@YZwH`Hu@j@cBn@kCb@oGbAkL`ABZ",
  UpdateTime: "2021-03-10T00:22:53+08:00",
  VersionID: 0,
};

const route = parseBusRouteData(testRoute.Geometry);
console.log(route);

const options = {
  strokeColor: "#5CBCDB",
  strokeWeight: 5,
  fillColor: "#5CBCDB",
  clickable: false,
  draggable: false,
  editable: false,
  visible: true,
  radius: 30000,
  zIndex: 1,
};

const BusDetailRealTimeStatusMap: React.FC = () => {
  const router = useRouter();

  const [MapCenter, setMapCenter] = useState({
    lat: 0,
    lng: 0,
  });

  const { isLoaded } = useJsApiLoader({
    id: "google-map-script",
    googleMapsApiKey: process.env.GOOGLE_MAP_API_KEY,
  });

  const onLoad = React.useCallback(function callback(map) {
    setMapCenter({ lat, lng });
  }, []);

  const onUnmount = React.useCallback(function callback(map) {}, []);

  return isLoaded ? (
    <GoogleMap
      mapContainerStyle={containerStyle}
      center={MapCenter}
      zoom={15}
      onLoad={onLoad}
      onUnmount={onUnmount}
      options={{
        mapTypeControl: false,
        zoomControl: false,
        streetViewControl: false,
        rotateControl: false,
        scaleControl: false,
        fullscreenControl: false,
        gestureHandling: "none",
        keyboardShortcuts: false,
      }}
    >
      {/* Child components, such as markers, info windows, etc. */}
      <FontAwesomeMarker
        position={position}
        icon={faCircle}
        color="#F66A4B"
        size={50}
      />

      <FontAwesomeMarker
        position={position}
        icon={faBus}
        color="#FFF"
        size={30}
      />

      <Polyline path={route} options={options} />
    </GoogleMap>
  ) : (
    <></>
  );
};

const FontAwesomeMarker: React.FC<{
  position: google.maps.LatLng | google.maps.LatLngLiteral;
  icon: IconDefinition;
  size?: number;
  color?: string;
}> = ({ position, size = 60, icon, color = "white" }) => (
  <Marker
    position={position}
    icon={{
      path: icon.icon[4] as string,
      fillColor: color,
      fillOpacity: 1,
      anchor: new google.maps.Point(
        icon.icon[0] / 2, // width
        icon.icon[1] / 2 // height
      ),
      scale: size / icon.icon[0],
    }}
  />
);

const containerStyle = {
  width: "50%",
  height: "100%",
};

const BusDetailRealTimeStatusHeader = muiStyled(Grid)(({ theme }) => ({
  width: "100%",
  paddingBottom: 14,
  paddingTop: 14,
}));

const ColorText = muiStyled("span")(({ theme }) => ({
  color: theme.palette.secondary.main,
}));

const BusDetailRealTimeStatusContainer = muiStyled(Stack)(({ theme }) => ({
  width: 414,
  // height: 470,
}));

const BusDetailRealTimeStatusBody = muiStyled(Grid)(({ theme }) => ({
  width: "100%",
  overflow: "auto",
}));

const steps = [
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
  {
    label: "Step",
  },
];

export default BusDetailRealTimeStatusMap;
